# Mini-TF: Deep Learning Engine from Scratch (C++)

–ü—Ä–æ–µ–∫—Ç –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —á–∏—Å—Ç–æ–º C++ —Å —Ü–µ–ª—å—é –∏–∑—É—á–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ç–µ–Ω–∑–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è.

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `Tensor` (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é, —Å—Ç—Ä–∞–π–¥—ã).
* –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤–∏–∂–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ).
* –ù–∞–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å–ª–æ–µ–≤ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–≤ (SGD, Adam).
* **Zero-Dependency:** –ú–∏–Ω–∏–º—É–º –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (—Ç–æ–ª—å–∫–æ STL –∏, –≤–æ–∑–º–æ–∂–Ω–æ, —Ç–µ—Å—Ç—ã).

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

### 1. Core (–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —è–¥—Ä–æ)

* **`tensor.hpp/cpp`**: –ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `shape`, `stride` –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.
* **`ops_cpu.hpp/cpp`**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è CPU-–∫–µ—Ä–Ω–µ–ª–æ–≤. –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ (MatMul) —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –∫—ç—à–∞.
* **`memory.hpp/cpp`**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º –ø–∞–º—è—Ç–∏ (aligned memory) –¥–ª—è –±—É–¥—É—â–µ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è SIMD.

### 2. Autograd (–î–≤–∏–∂–æ–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤)

* **`node.hpp`**: –ë–∞–∑–æ–≤–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –≥—Ä–∞—Ñ–∞. –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ (`Value`) –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç (`Grad`).
* **`engine.hpp`**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏ (Backpropagation) —á–µ—Ä–µ–∑ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É.

### 3. NN & Optim (–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ API)

* **`layers.hpp`**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ —Å–ª–æ–µ–≤. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ (Xavier/He).
* **`loss.hpp`**: –§—É–Ω–∫—Ü–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (MSE, Cross-Entropy).
* **`optimizer.hpp`**: –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

---

## üöÄ –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ (Roadmap)

1. **Phase 1 (Basic Math):** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `Tensor` –∏ –±–∞–∑–æ–≤–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü.
2. **Phase 2 (Scalar Autograd):** –°–æ–∑–¥–∞—Ç—å –¥–≤–∏–∂–æ–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å micrograd).
3. **Phase 3 (Tensor Autograd):** –†–∞—Å—à–∏—Ä–∏—Ç—å –¥–≤–∏–∂–æ–∫ –Ω–∞ –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.
4. **Phase 4 (Neural Network):** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∏ `Dense` –∏ `ReLU`.
5. **Phase 5 (Application):** –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö MNIST (–≤ `examples/mnist_train.cpp`).

---

## üõ† –°–±–æ—Ä–∫–∞

–î–ª—è —Å–±–æ—Ä–∫–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **CMake** –≤–µ—Ä—Å–∏–∏ 3.10+ –∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **C++17**.

```bash
mkdir build && cd build
cmake ..
make
./mini_tf_run

```

OR

```
cmake --build build --target mnist_train
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è unit-—Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –º–∞—Ç–∞–Ω–∞.

* –ü—Ä–æ–≤–µ—Ä–∫–∞ `MatMul` –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º.
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (Gradient Checking) ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —Å —á–∏—Å–ª–µ–Ω–Ω—ã–º.

---

### –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è (–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)

```cpp
#include "mini_tf.hpp"

// –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞
auto x = mtf::Variable({2, 2}, true); // true = –Ω—É–∂–µ–Ω –≥—Ä–∞–¥–∏–µ–Ω—Ç
auto w = mtf::Variable({2, 2}, true);
auto b = mtf::Variable({2, 1}, true);

auto y = mtf::matmul(w, x) + b;
y.backward(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–ª—è x, w, b

```

---
